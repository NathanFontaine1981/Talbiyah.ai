// Content with EXACT format the parser expects
const detailedContent = `## Lesson Summary

**Lesson Type:** ðŸ“– Understanding & Tadabbur

**Surah:** Ø³ÙÙˆØ±ÙŽØ©Ù Ø§Ù„Ù†ÙŽÙ‘Ø§Ø²ÙØ¹ÙŽØ§Øª â€” An-NÄziÊ¿Ät (The Extractors)
**Chapter:** 79 | **Ayahs:** 1â€“33
**Theme:** Resurrection, Angels, Musa & Fir'awn, Allah's Creation
**Teacher:** Ustadh Osama Muhammad
**Date:** 30th November 2025

This session focused on deeply understanding Surah An-Nazi'at. We explored the powerful oaths about angels, the terrifying Day of Resurrection, the story of Musa and Fir'awn's arrogance, and Allah's creation as undeniable proof of His power to resurrect.

---

## Vocabulary

| Arabic | Transliteration | English |
|--------|-----------------|---------|
| Ø§Ù„Ù†ÙŽÙ‘Ø§Ø²ÙØ¹ÙŽØ§Øª | an-nÄziÊ¿Ät | those who extract (angels pulling souls) |
| ØºÙŽØ±Ù’Ù‚Ù‹Ø§ | gharqan | with violence, deeply |
| Ø·ÙŽØºÙŽÙ‰Ù° | á¹­aghÄ | he transgressed |
| ØªÙŽØ²ÙŽÙƒÙŽÙ‘Ù‰Ù° | tazakkÄ | to purify oneself |
| Ø§Ù„Ø±ÙŽÙ‘Ø§Ø¬ÙÙÙŽØ© | ar-rÄjifah | the quaking (first trumpet) |
| Ø§Ù„Ø±ÙŽÙ‘Ø§Ø¯ÙÙÙŽØ© | ar-rÄdifah | the subsequent (second trumpet) |
| ÙˆÙŽØ§Ø¬ÙÙÙŽØ© | wÄjifah | trembling |
| Ø®ÙŽØ§Ø´ÙØ¹ÙŽØ© | khÄshiÊ¿ah | humbled |
| Ø¯ÙŽØ­ÙŽØ§Ù‡ÙŽØ§ | daá¸¥ÄhÄ | He spread it out |
| Ø£ÙŽØ±Ù’Ø³ÙŽØ§Ù‡ÙŽØ§ | arsÄhÄ | He set firmly |
| Ù…ÙŽØªÙŽØ§Ø¹ | matÄÊ¿ | provision, enjoyment |
| Ø£ÙŽÙ†Ù’Ø¹ÙŽØ§Ù… | anÊ¿Äm | livestock, cattle |

---

## Key Sentences

| Arabic | Transliteration | English |
|--------|-----------------|---------|
| ÙˆÙŽØ§Ù„Ù†ÙŽÙ‘Ø§Ø²ÙØ¹ÙŽØ§ØªÙ ØºÙŽØ±Ù’Ù‚Ù‹Ø§ | wan-nÄziÊ¿Äti gharqÄ | By those who extract with violence |
| ÙˆÙŽØ§Ù„Ù†ÙŽÙ‘Ø§Ø´ÙØ·ÙŽØ§ØªÙ Ù†ÙŽØ´Ù’Ø·Ù‹Ø§ | wan-nÄshiá¹­Äti nashá¹­Ä | And those who remove with ease |
| Ù‡ÙŽÙ„Ù’ Ø£ÙŽØªÙŽØ§ÙƒÙŽ Ø­ÙŽØ¯ÙÙŠØ«Ù Ù…ÙÙˆØ³ÙŽÙ‰Ù° | hal atÄka á¸¥adÄ«thu mÅ«sÄ | Has there reached you the story of Musa? |
| Ø§Ø°Ù’Ù‡ÙŽØ¨Ù’ Ø¥ÙÙ„ÙŽÙ‰Ù° ÙÙØ±Ù’Ø¹ÙŽÙˆÙ’Ù†ÙŽ Ø¥ÙÙ†ÙŽÙ‘Ù‡Ù Ø·ÙŽØºÙŽÙ‰Ù° | idhab ilÄ firÊ¿awna innahu á¹­aghÄ | Go to Fir'awn, he has transgressed |
| ÙÙŽÙ‚ÙŽØ§Ù„ÙŽ Ø£ÙŽÙ†ÙŽØ§ Ø±ÙŽØ¨ÙÙ‘ÙƒÙÙ…Ù Ø§Ù„Ù’Ø£ÙŽØ¹Ù’Ù„ÙŽÙ‰Ù° | faqÄla ana rabbukumul-aÊ¿lÄ | He said: I am your lord, most high |
| Ù‚ÙÙ„ÙÙˆØ¨ÙŒ ÙŠÙŽÙˆÙ’Ù…ÙŽØ¦ÙØ°Ù ÙˆÙŽØ§Ø¬ÙÙÙŽØ©ÙŒ | qulÅ«bun yawma'idhin wÄjifah | Hearts that Day will tremble |
| Ø£ÙŽØ¨Ù’ØµÙŽØ§Ø±ÙÙ‡ÙŽØ§ Ø®ÙŽØ§Ø´ÙØ¹ÙŽØ©ÙŒ | abá¹£ÄruhÄ khÄshiÊ¿ah | Their eyes humbled |
| Ù…ÙŽØªÙŽØ§Ø¹Ù‹Ø§ Ù„ÙŽÙ‘ÙƒÙÙ…Ù’ ÙˆÙŽÙ„ÙØ£ÙŽÙ†Ù’Ø¹ÙŽØ§Ù…ÙÙƒÙÙ…Ù’ | matÄÊ¿an lakum wa li'anÊ¿Ämikum | As provision for you and your livestock |

---

## Teacher Notes

### Understanding the Message

**The Angels (Ayahs 1-5):**
Allah opens with powerful oaths about the angels. **Ø§Ù„Ù†ÙŽÙ‘Ø§Ø²ÙØ¹ÙŽØ§Øª** extract the souls of disbelievers harshly, while **Ø§Ù„Ù†ÙŽÙ‘Ø§Ø´ÙØ·ÙŽØ§Øª** gently release the souls of believers. How you live determines how your soul departs.

**The Day of Terror (Ayahs 6-14):**
Two blasts will shake everything â€” **Ø§Ù„Ø±ÙŽÙ‘Ø§Ø¬ÙÙÙŽØ©** kills all creation, **Ø§Ù„Ø±ÙŽÙ‘Ø§Ø¯ÙÙÙŽØ©** resurrects everyone. Hearts will be **ÙˆÙŽØ§Ø¬ÙÙÙŽØ©** (trembling) and eyes **Ø®ÙŽØ§Ø´ÙØ¹ÙŽØ©** (humbled).

**Fir'awn's Arrogance (Ayahs 15-26):**
Fir'awn **Ø·ÙŽØºÙŽÙ‰Ù°** (transgressed all limits). Musa invited him to **ØªÙŽØ²ÙŽÙƒÙŽÙ‘Ù‰Ù°** (purify himself), but he claimed: **Ø£ÙŽÙ†ÙŽØ§ Ø±ÙŽØ¨ÙÙ‘ÙƒÙÙ…Ù Ø§Ù„Ù’Ø£ÙŽØ¹Ù’Ù„ÙŽÙ‰Ù°** â€” "I am your highest lord." Allah seized him as a warning.

**Proof of Resurrection (Ayahs 27-33):**
Allah asks: "Are YOU harder to create, or the heavens?" He spread the earth (**Ø¯ÙŽØ­ÙŽØ§Ù‡ÙŽØ§**), anchored mountains (**Ø£ÙŽØ±Ù’Ø³ÙŽØ§Ù‡ÙŽØ§**), brought water and pasture â€” all as **Ù…ÙŽØªÙŽØ§Ø¹** (provision) for you.

### First Word Prompts for Memorisation

| Ayah | First Word | Full Ayah |
|------|------------|-----------|
| 1 | ÙˆÙŽØ§Ù„Ù†ÙŽÙ‘Ø§Ø²ÙØ¹ÙŽØ§ØªÙ | ÙˆÙŽØ§Ù„Ù†ÙŽÙ‘Ø§Ø²ÙØ¹ÙŽØ§ØªÙ ØºÙŽØ±Ù’Ù‚Ù‹Ø§ |
| 2 | ÙˆÙŽØ§Ù„Ù†ÙŽÙ‘Ø§Ø´ÙØ·ÙŽØ§ØªÙ | ÙˆÙŽØ§Ù„Ù†ÙŽÙ‘Ø§Ø´ÙØ·ÙŽØ§ØªÙ Ù†ÙŽØ´Ù’Ø·Ù‹Ø§ |
| 15 | Ù‡ÙŽÙ„Ù’ | Ù‡ÙŽÙ„Ù’ Ø£ÙŽØªÙŽØ§ÙƒÙŽ Ø­ÙŽØ¯ÙÙŠØ«Ù Ù…ÙÙˆØ³ÙŽÙ‰Ù° |
| 17 | Ø§Ø°Ù’Ù‡ÙŽØ¨Ù’ | Ø§Ø°Ù’Ù‡ÙŽØ¨Ù’ Ø¥ÙÙ„ÙŽÙ‰Ù° ÙÙØ±Ù’Ø¹ÙŽÙˆÙ’Ù†ÙŽ |
| 24 | ÙÙŽÙ‚ÙŽØ§Ù„ÙŽ | ÙÙŽÙ‚ÙŽØ§Ù„ÙŽ Ø£ÙŽÙ†ÙŽØ§ Ø±ÙŽØ¨ÙÙ‘ÙƒÙÙ…Ù Ø§Ù„Ù’Ø£ÙŽØ¹Ù’Ù„ÙŽÙ‰Ù° |
| 33 | Ù…ÙŽØªÙŽØ§Ø¹Ù‹Ø§ | Ù…ÙŽØªÙŽØ§Ø¹Ù‹Ø§ Ù„ÙŽÙ‘ÙƒÙÙ…Ù’ ÙˆÙŽÙ„ÙØ£ÙŽÙ†Ù’Ø¹ÙŽØ§Ù…ÙÙƒÙÙ…Ù’ |

---

## Mini Quiz

1. Match: "By those who extract with violence"
A) ÙˆÙŽØ§Ù„Ù†ÙŽÙ‘Ø§Ø´ÙØ·ÙŽØ§ØªÙ Ù†ÙŽØ´Ù’Ø·Ù‹Ø§
B) ÙˆÙŽØ§Ù„Ù†ÙŽÙ‘Ø§Ø²ÙØ¹ÙŽØ§ØªÙ ØºÙŽØ±Ù’Ù‚Ù‹Ø§ âœ…
C) ÙÙŽØ§Ù„Ø³ÙŽÙ‘Ø§Ø¨ÙÙ‚ÙŽØ§ØªÙ Ø³ÙŽØ¨Ù’Ù‚Ù‹Ø§

2. Match: "Go to Fir'awn. He has transgressed"
A) Ù‡ÙŽÙ„Ù’ Ø£ÙŽØªÙŽØ§ÙƒÙŽ Ø­ÙŽØ¯ÙÙŠØ«Ù Ù…ÙÙˆØ³ÙŽÙ‰Ù°
B) Ø§Ø°Ù’Ù‡ÙŽØ¨Ù’ Ø¥ÙÙ„ÙŽÙ‰Ù° ÙÙØ±Ù’Ø¹ÙŽÙˆÙ’Ù†ÙŽ Ø¥ÙÙ†ÙŽÙ‘Ù‡Ù Ø·ÙŽØºÙŽÙ‰Ù° âœ…
C) ÙÙŽÙ‚ÙÙ„Ù’ Ù‡ÙŽÙ„ Ù„ÙŽÙ‘ÙƒÙŽ Ø¥ÙÙ„ÙŽÙ‰Ù° Ø£ÙŽÙ† ØªÙŽØ²ÙŽÙƒÙŽÙ‘Ù‰Ù°

3. Match: "I am your lord, most high"
A) ÙÙŽÙ‚ÙŽØ§Ù„ÙŽ Ø£ÙŽÙ†ÙŽØ§ Ø±ÙŽØ¨ÙÙ‘ÙƒÙÙ…Ù Ø§Ù„Ù’Ø£ÙŽØ¹Ù’Ù„ÙŽÙ‰Ù° âœ…
B) Ø¥ÙÙ†ÙŽÙ‘Ù‡Ù Ø·ÙŽØºÙŽÙ‰Ù°
C) ÙÙŽØ£ÙŽØ®ÙŽØ°ÙŽÙ‡Ù Ø§Ù„Ù„ÙŽÙ‘Ù‡Ù

4. Match: "Hearts that Day will tremble"
A) Ø£ÙŽØ¨Ù’ØµÙŽØ§Ø±ÙÙ‡ÙŽØ§ Ø®ÙŽØ§Ø´ÙØ¹ÙŽØ©ÙŒ
B) Ù‚ÙÙ„ÙÙˆØ¨ÙŒ ÙŠÙŽÙˆÙ’Ù…ÙŽØ¦ÙØ°Ù ÙˆÙŽØ§Ø¬ÙÙÙŽØ©ÙŒ âœ…
C) ØªÙŽØªÙ’Ø¨ÙŽØ¹ÙÙ‡ÙŽØ§ Ø§Ù„Ø±ÙŽÙ‘Ø§Ø¯ÙÙÙŽØ©Ù

5. Match: "As provision for you and your livestock"
A) ÙˆÙŽØ§Ù„Ù’Ø¬ÙØ¨ÙŽØ§Ù„ÙŽ Ø£ÙŽØ±Ù’Ø³ÙŽØ§Ù‡ÙŽØ§
B) Ù…ÙŽØªÙŽØ§Ø¹Ù‹Ø§ Ù„ÙŽÙ‘ÙƒÙÙ…Ù’ ÙˆÙŽÙ„ÙØ£ÙŽÙ†Ù’Ø¹ÙŽØ§Ù…ÙÙƒÙÙ…Ù’ âœ…
C) Ø£ÙŽØ®Ù’Ø±ÙŽØ¬ÙŽ Ù…ÙÙ†Ù’Ù‡ÙŽØ§ Ù…ÙŽØ§Ø¡ÙŽÙ‡ÙŽØ§

6. What does Ø·ÙŽØºÙŽÙ‰Ù° mean?
A) He purified himself
B) He transgressed âœ…
C) He believed

7. What does Ù…ÙŽØªÙŽØ§Ø¹ mean?
A) Mountains
B) Livestock
C) Provision/Enjoyment âœ…

---

## Homework

ðŸ“ Memorise vocabulary: Learn all 12 focus words with meanings
ðŸ“– Ayah recognition: Practice the quiz until you score 7/7
ðŸ“– First word drill: Cover ayahs, use first word to recall the rest
ðŸ“ Tadabbur reflection: Write 3-5 sentences on "What does Fir'awn's story teach me about arrogance?"
ðŸ“– Prepare next session: Read ayahs 34-46 with translation

---

## Key Takeaways

â€¢ How you live determines how your soul departs â€” believers' souls taken gently, disbelievers' harshly

â€¢ Fir'awn's sin was Ø·ÙØºÙ’ÙŠÙŽØ§Ù† (transgression) â€” claiming to be the highest lord when only Allah is

â€¢ Allah's creation proves resurrection â€” if He made heavens, earth, mountains, raising you is easy

â€¢ Everything is Ù…ÙŽØªÙŽØ§Ø¹ â€” temporary provision. Be grateful, don't become attached

â€¢ Hearts will tremble, eyes will be humbled â€” prepare now so you're not among the terrified

---

## Final Reflection

### Tadabbur Prompts

**Ayah 1-2:** How do I want my soul to be taken? What am I doing to prepare?

**Ayah 8-9:** My heart will tremble that Day. What makes it tremble with fear of Allah today?

**Ayah 17:** Musa was sent to the most powerful tyrant. What difficult task is Allah asking of me?

**Ayah 24:** Fir'awn claimed to be the highest. In what small ways do I put my ego above Allah's commands?

**Ayah 33:** Everything I enjoy is Ù…ÙŽØªÙŽØ§Ø¹ â€” temporary provision. Am I grateful enough?

### Verse to Carry With You

> Ù‚ÙÙ„ÙÙˆØ¨ÙŒ ÙŠÙŽÙˆÙ’Ù…ÙŽØ¦ÙØ°Ù ÙˆÙŽØ§Ø¬ÙÙÙŽØ©ÙŒ Û Ø£ÙŽØ¨Ù’ØµÙŽØ§Ø±ÙÙ‡ÙŽØ§ Ø®ÙŽØ§Ø´ÙØ¹ÙŽØ©ÙŒ
> "Hearts, that Day, will tremble. Their eyes humbled."
> â€” Surah An-Nazi'at, 79:8-9`;

const updateData = {
  title: "Surah An-Nazi'at (79) â€” Ayahs 1-33",
  summary: "Understanding & Tadabbur session on Surah An-Nazi'at. Explored the oaths about angels extracting souls, Fir'awn's arrogance and downfall, and Allah's creation as proof of resurrection.",
  key_topics: [
    "Angels & soul extraction",
    "Fir'awn's transgression (Ø·ÙŽØºÙŽÙ‰Ù°)",
    "Day of Resurrection",
    "Allah's creation as proof",
    "Provision (Ù…ÙŽØªÙŽØ§Ø¹)"
  ],
  detailed_insights: {
    content: detailedContent,
    metadata: {
      generated_at: new Date().toISOString(),
      source: "lesson_content",
      model: "quran_insight_template_v5",
      lesson_type: "understanding_tadabbur",
      lesson_date: "2025-11-30",
      teacher: "Osama Muhammad",
      student: "Nathan Fontaine",
      subject: "Quran with Understanding",
      surah_name: "An-Nazi'at",
      surah_number: 79,
      ayah_range: "1-33"
    }
  }
};

const payload = {
  insightId: 'def6b825-f0c2-4058-bbe9-1a72c1720b56',
  updateData: updateData
};

console.log('Calling Edge function...');

const response = await fetch('https://boyrjgivpepjiboekwuu.supabase.co/functions/v1/update-insight-content', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJveXJqZ2l2cGVwamlib2Vrd3V1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE2ODI3MDcsImV4cCI6MjA3NzI1ODcwN30.-BEMiplFBMTofQDc68bSGDhW4YkH8xTtiohk-IFfzzU'
  },
  body: JSON.stringify(payload)
});

const result = await response.json();
console.log('Result:', JSON.stringify(result, null, 2));
